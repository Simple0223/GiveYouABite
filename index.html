 ＃分你一口 點餐區

<form id="orderForm">
  <div>
    <label for="customerName">顧客姓名：</label>
    <input type="text" id="customerName" name="customerName" required><br><br>
  </div>
  
  <div>
    <label for="phone">電話：</label>
    <input type="tel" id="phone" name="phone" required><br><br>
  </div>

  <div>
    <label for="address">地址：</label>
    <input type="text" id="address" name="address" required><br><br>
  </div>

  <div>
    <label for="tiramisu">提拉米蘇 (NT$ 150)：</label>
    <input type="number" id="tiramisu" name="tiramisu" min="0" value="0" onchange="calculateTotal()">
  </div>
  <div>
    <label for="chestnut-layer-fruit">原味千層 (NT$ 120)：</label>
    <input type="number" id="chestnut-layer-original" name="chestnut-layer-fruit" min="0" value="0" onchange="calculateTotal()">
  </div>
  <div>
    <label for="chestnut-layer-original">水果千層 (NT$ 130)：</label>
    <input type="number" id="chestnut-layer-fruit" name="chestnut-layer-original" min="0" value="0" onchange="calculateTotal()">
  </div>
  <div>
    <label for="chestnut-layer-chocolate">巧克力千層 (NT$ 130)：</label>
    <input type="number" id="chestnut-layer-chocolate" name="chestnut-layer-chocolate" min="0" value="0" onchange="calculateTotal()">
  </div>
  <div>
    <label for="classic-cheese">經典起司 (NT$ 180)：</label>
    <input type="number" id="classic-cheese" name="classic-cheese" min="0" value="0" onchange="calculateTotal()">
  </div>
  <div>
    <label for="bask">巴斯克 (NT$ 200)：</label>
    <input type="number" id="bask" name="bask" min="0" value="0" onchange="calculateTotal()">
  </div>
  <div>
    <label for="lemon-tart">檸檬塔 (NT$ 160)：</label>
    <input type="number" id="lemon-tart" name="lemon-tart" min="0" value="0" onchange="calculateTotal()">
  </div>

  <br>
  <div>
    <label for="totalAmount">總金額：</label>
    <span id="totalAmount">NT$ 0</span>
  </div>

  <button type="submit">送出訂單</button>
</form>

<div id="status"></div>

<script>
  function calculateTotal() {
    // 定義品項和價格
    const items = [
      { name: '提拉米蘇', price: 150, quantity: document.getElementById('tiramisu').value },
      { name: '原味千層', price: 120, quantity: document.getElementById('chestnut-layer-original').value },
      { name: '水果千層', price: 120, quantity: document.getElementById('chestnut-layer-fruit').value },
      { name: '巧克力千層', price: 130, quantity: document.getElementById('chestnut-layer-chocolate').value },
      { name: '經典起司', price: 180, quantity: document.getElementById('classic-cheese').value },
      { name: '巴斯克', price: 200, quantity: document.getElementById('bask').value },
      { name: '檸檬塔', price: 160, quantity: document.getElementById('lemon-tart').value },
    ];

    // 計算總金額
    let totalAmount = 0;
    items.forEach(item => {
      totalAmount += item.price * item.quantity;
    });

    // 更新總金額顯示
    document.getElementById('totalAmount').innerText = 'NT$ ' + totalAmount;
  }

  document.getElementById('orderForm').addEventListener('submit', function(e) {
    e.preventDefault();

    // 收集表單資料
    const orderId = Math.random().toString(36).substr(2, 9); // 隨機生成訂單編號
    const customerName = document.getElementById('customerName').value;
    const phone = document.getElementById('phone').value;
    const address = document.getElementById('address').value;

    // 定義品項和價格
    const items = [
      { name: '提拉米蘇', price: 150, quantity: document.getElementById('tiramisu').value },
      { name: '原味千層', price: 120, quantity: document.getElementById('chestnut-layer-original').value },
      { name: '水果千層', price: 120, quantity: document.getElementById('chestnut-layer-fruit').value },
      { name: '巧克力千層', price: 130, quantity: document.getElementById('chestnut-layer-chocolate').value },
      { name: '經典起司', price: 180, quantity: document.getElementById('classic-cheese').value },
      { name: '巴斯克', price: 200, quantity: document.getElementById('bask').value },
      { name: '檸檬塔', price: 160, quantity: document.getElementById('lemon-tart').value },
    ];

    // 計算總金額
    let totalAmount = 0;
    items.forEach(item => {
      totalAmount += item.price * item.quantity;
    });

    // 建立訂單資料
    const orderData = { orderId, customerName, phone, address, items, totalAmount };

    // 傳送資料到 Google Sheets API
    fetch('https://script.google.com/macros/s/AKfycbydjXkbSXa8ZAO6wsBOH-YS44babk3HYc5G9PyRe5jbja2F4XlD0DBrOKWXpeo7Pt0H/exec', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(orderData)
    })
    .then(response => response.json())
    .then(data => {
      if (data.status === 'success') {
        document.getElementById('status').innerText = '訂單已成功提交！';
      } else {
        document.getElementById('status').innerText = '訂單提交失敗，請再試一次。';
      }
    })
    .catch(error => {
      console.error('錯誤:', error);
      document.getElementById('status').innerText = '提交失敗，請稍後再試。';
    });
  });
</script>
