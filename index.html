<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ¨ ä¸€å£åˆ†ç”œ</title>

    <style>
        /* è¼¸å…¥æ¡†çµ±ä¸€æ¨£å¼ */
        input[type="text"],
        input[type="number"],
        input[type="email"],
        input[type="date"],
        select {
            width: 100%;
            padding: 10px 12px;
            margin-top: 6px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-size: 14px;
            box-sizing: border-box;
        }

            /* è¼¸å…¥æ¡† focus æ•ˆæœ */
            input:focus,
            select:focus {
                outline: none;
                border-color: #d1ae79;
                box-shadow: 0 0 0 3px rgba(230,164,180,0.2);
            }

        /* é€å‡ºæŒ‰éˆ• */
        button[type="submit"] {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: #d1ae79;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

            /* æ»‘éæ•ˆæœ */
            button[type="submit"]:hover {
                background: #a18c6d;
                transform: translateY(-2px);
            }

        body {
            background-image: url('èƒŒæ™¯.jpg');
            background-size: cover;
            background-position: bottom;
            background-repeat: no-repeat;
            background-attachment: fixed;
            font-family: "Noto Sans TC",sans-serif;
            padding: 40px 15px;
        }

        .section {
            max-width: 850px;
            margin: auto;
            background: rgba(255,255,255,0.95);
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        h1, h3 {
            font-weight: 700;
        }

        .price {
            font-weight: bold;
            color: #8b5e3c;
        }

        .total-box {
            font-size: 18px;
            font-weight: bold;
            line-height: 1.8;
        }

        .text-center {
            text-align: center;
        }
    </style>
</head>

<body>

    <div class="section text-center">
        <h1>âœ¨ ä¸€å£åˆ†ç”œ</h1>
        <p>
            ä»¥åš´é¸é£Ÿæèˆ‡ç´°è†©å·¥æ³•ï¼Œè£½ä½œæ¯ä¸€ä»½å€¼å¾—æœŸå¾…çš„ç”œé»ã€‚<br>
            ä¹ŸæœŸæœ›æŠŠå¥½åƒçš„ç”œé»åˆ†äº«å‡ºå»ï¼<br>
            åœ¨3/14ï¼ˆå…­ï¼‰æœƒæœ‰ä¸€å¤©çš„å¯¦é«”åº—é¢ï¼æ­¡è¿å¤§å®¶ä¾†ååï¼
        </p>
    </div>

    <div class="section notice">
        <h3>ğŸ“Œ è¨‚è³¼é ˆçŸ¥</h3>
        ç”œé»çš†ç‚ºæ‰‹å·¥è£½ä½œï¼Œéœ€å†·è—ä¿å­˜ï¼Œè«‹å„˜æ—©äº«ç”¨ã€‚<br>
        åŒ¯æ¬¾å®Œæˆï¼Œæ”¶åˆ°emailç¢ºèªä¿¡ä»¶å¾Œè¨‚å–®æ‰æˆç«‹ã€‚<br>
        3/8å‰é è¨‚å¯äº«9æŠ˜å„ªæƒ ï¼Œæ»¿åƒäº«å…é‹ã€‚<br>
        ç•¶å¤©3/14å–è²¨å¯ä»¥å…§ç”¨æˆ–å¤–å¸¶ã€‚<br>
        ã€Œå†·è—å¯„é€ã€é‹è²»ç‚º80å…ƒï¼ˆå·´æ–¯å…‹å’Œæª¸æª¬ç£…è›‹ç³•åƒ…æä¾›6å¯¸æ•´é¡†åŠæ•´æ¢è›‹ç³•ï¼‰ï¼Œä¾è¨‚å–®é †åºä¾åºæ–¼3/16åŠ3/23å‡ºè²¨ã€‚
    </div>

    <form id="orderForm"
          action="https://docs.google.com/forms/d/e/1FAIpQLSeddvVROwPivkCKsaZJ1pBOSqSxcptIsGFHtQweB9I88jDzKg/formResponse"
          method="post"
          target="hidden_iframe"
          onsubmit="return prepareSubmit();">

        <iframe name="hidden_iframe"
                style="display:none;"
                onload="submitted()"></iframe>

        <div class="section">
            <h3>
                ğŸ° ææ‹‰ç±³è˜‡
            </h3>
            è³¼è²·æ•¸é‡(NT$180)ï¼š
            <input type="number" id="tiramisu" value="0" min="0" oninput="this.value = Math.max(0, this.value)" onchange="calculate()"><br><br>
            Mascarpone çµåˆæ¿ƒç¸®å’–å•¡èˆ‡æ‰‹æŒ‡é¤…ä¹¾ï¼Œå…¥å£æŸ”æ»‘ç´°ç·»ã€æ¿•æ½¤ç¶¿å¯†ï¼Œ<br>
            å’–å•¡è‹¦ç”œèˆ‡å¥¶é¦™å±¤å±¤äº¤ç¹”ï¼Œå‘ˆç¾ç¶“å…¸è€Œè¿·äººçš„ææ‹‰ç±³è˜‡é¢¨å‘³ã€‚<br>
            åŸæ–™ï½œMascarponeã€Espresoï¼ˆç¾©å¤§åˆ©é‡‘æ¯å’–å•¡ï¼‰ã€é®®å¥¶æ²¹ã€æœ‰æ©Ÿç´…ç³–ã€æœ‰æ©Ÿé›è›‹ï¼ˆç”Ÿï¼‰ã€ç¾©å¤§åˆ©Boninomiæ‰‹æŒ‡é¤…ä¹¾
        </div>

        <div class="section">
            <h3>
                ğŸ§€ å·´æ–¯å…‹ä¹³é…ªè›‹ç³•
            </h3>
            è³¼è²·æ•¸é‡(åˆ‡ç‰‡/NT$140)ï¼š
            <input type="number" id="basque_slice" value="0" min="0" oninput="this.value = Math.max(0, this.value)" onchange="calculate()"><br><br>
            è³¼è²·æ•¸é‡(6å‹/NT$680)ï¼š
            <input type="number" id="basque_whole" value="0" min="0" oninput="this.value = Math.max(0, this.value)" onchange="calculate()"><br><br>
            é«˜æº«çƒ˜çƒ¤å½¢æˆå¾®ç„¦é¦™è¡¨é¢ï¼Œå…§å±¤æŸ”è»Ÿæ¿•æ½¤ï¼Œä¹³é…ªé¦™æ°£æ¿ƒéƒã€‚<br>
            åŸæ–™ï½œCream Cheeseã€æœ‰æ©Ÿç´…ç³–ã€æœ‰æ©Ÿè›‹ã€é®®å¥¶æ²¹ã€é…¸å¥¶ã€ä½ç­‹éºµç²‰
        </div>

        <div class="section">
            <h3>
                ğŸ‹ æª¸æª¬æ¡‚èŠ±ç£…è›‹ç³•
            </h3>
            è³¼è²·æ•¸é‡(åˆ‡ç‰‡/NT$140)ï¼š
            <input type="number" id="lemon_slice" value="0" min="0" oninput="this.value = Math.max(0, this.value)" onchange="calculate()"><br><br>
            è³¼è²·æ•¸é‡(6å‹/NT$720)ï¼š
            <input type="number" id="lemon_whole" value="0" min="0" oninput="this.value = Math.max(0, this.value)" onchange="calculate()"><br><br>
            é¸ç”¨æ³•åœ‹ä¾æ€å°¼ç™¼é…µå¥¶æ²¹èˆ‡æ–°é®®æª¸æª¬ï¼Œèåˆæ·¡é›…æ¡‚èŠ±é¦™ï¼Œé¢¨å‘³æ¸…æ–°ç´°ç·»ï¼Œé…¸ç”œé©ä¸­ã€‚
            <br>
            åŸæ–™ï½œæ³•åœ‹ T45 éºµç²‰ã€ä¾æ€å°¼ç„¡é¹½ç™¼é…µå¥¶æ²¹ã€æ—¥æœ¬ä¸Šç™½ç³–ã€å‹å–„æ”¾ç‰§é›è›‹ã€ç³–ç²‰ã€æª¸æª¬ã€ä¹¾ç‡¥æ¡‚èŠ±<br>
            *å«è›‹ã€å¥¶åŠéº©è³ªç­‰éæ•åŸï¼Œè«‹è‡ªè¡Œæ–Ÿé…Œè¨‚è³¼ã€‚
        </div>

        <div class="section">
            <h3>ğŸšš å–è²¨è³‡è¨Š</h3>

            å–è²¨æ–¹å¼ï¼š
            <select id="pickupMethod" onchange="calculate()" required>
                <option value="è‡ªå–">è‡ªå–</option>
                <option value="å†·è—å®…é…">å†·è—å®…é…</option>
            </select><br><br>

            å–è²¨æ—¥ï¼š
            <input type="date" id="pickupDate" required><br><br>

            <div id="addressBlock" style="display:none;">
                å®…é…åœ°å€
                <input type="text" id="shippingAddress">
            </div>

        </div>

        <div class="section total-box">
            åŸåƒ¹ï¼šNT$ <span id="subtotal">0</span><br>
            æŠ˜æ‰£å¾Œï¼šNT$ <span id="discounted">0</span><br>
            é‹è²»ï¼šNT$ <span id="shipping">0</span><br>
            <strong>æ‡‰ä»˜ç¸½é¡ï¼šNT$ <span id="final">0</span></strong>
        </div>

        <div class="section">
            <h3>ğŸ’° åŒ¯æ¬¾è³‡è¨Š</h3>
            ä¸­åœ‹ä¿¡è¨—<br>
            ä»£ç¢¼822 å¸³è™Ÿ406890018424<br><br>
        </div>

        <div class="section">
            <h3>ğŸ“ è¯çµ¡æˆ‘å€‘</h3>
            é›»è©±ï¼šéƒ­å…ˆç”Ÿ 0981189371 / é™³å°å§ 0988755638<br>
            Line IDï¼š0981189371<br>
            åœ°å€ï¼šè‡ºåŒ—å¸‚ä¸­å±±å€ä¸­åŸè¡—3è™Ÿ1æ¨“
        </div>

        <div class="section">

            <h3>ğŸ“ è¨‚å–®è³‡è¨Š</h3>

            å§“åï¼š
            <input type="text" name="entry.1915730164" required><br><br>

            é›»è©±ï¼š
            <input type="text" name="entry.1422224818" required><br><br>

            ä¿¡ç®±ï¼š
            <input type="email" name="entry.1477996357" required><br><br>

            åŒ¯æ¬¾å¾Œäº”ç¢¼ï¼š
            <input type="text" name="entry.801140470" required><br><br>

            <input type="hidden" name="entry.665904672" id="pickupInfoField">
            <input type="hidden" name="entry.1983505291" id="summaryField">
            <input type="hidden" name="entry.1066634627" id="subtotalField">
            <input type="hidden" name="entry.1764733801" id="discountField">
            <input type="hidden" name="entry.943674488" id="shippingField">
            <input type="hidden" name="entry.1636048135" id="finalField">

            <button type="submit">é€å‡ºè¨‚å–®</button>

        </div>
    </form>

    <script>
        let currentSubtotal = 0;
        let currentDiscounted = 0;
        let currentShipping = 0;
        let currentFinal = 0;
        let formSubmitted = false;

        function calculate() {

            let t = 180 * (parseInt(tiramisu.value) || 0);
            let b1 = 140 * (parseInt(basque_slice.value) || 0);
            let b2 = 680 * (parseInt(basque_whole.value) || 0);
            let l1 = 140 * (parseInt(lemon_slice.value) || 0);
            let l2 = 720 * (parseInt(lemon_whole.value) || 0);

            currentSubtotal = t + b1 + b2 + l1 + l2;

            currentDiscounted = currentSubtotal;

            let today = new Date();
            let deadline = new Date(today.getFullYear(), 2, 8);

            if (today <= deadline) {
                currentDiscounted = Math.floor(currentSubtotal * 0.9);
            }

            let method = pickupMethod.value;
            currentShipping = 0;

            if (method === "å†·è—å®…é…") {
                currentShipping = currentDiscounted >= 1000 ? 0 : 80;
                addressBlock.style.display = "block";
            } else {
                addressBlock.style.display = "none";
            }

            currentFinal = currentDiscounted + currentShipping;

            subtotal.innerText = currentSubtotal;
            discounted.innerText = currentDiscounted;
            shipping.innerText = currentShipping;
            final.innerText = currentFinal;

        }

        function prepareSubmit() {

            calculate();

            // æ•¸å­—ç©ºå€¼ä¿è­·ï¼ˆå†ä¿éšªï¼‰
            let inputs = [tiramisu, basque_slice, basque_whole, lemon_slice, lemon_whole];
            inputs.forEach(input => {
                if (input.value === "" || input.value < 0) {
                    input.value = 0;
                }
            });

            // æ—¥æœŸé˜²å‘†ï¼šä¸èƒ½æ—©æ–¼ä»Šå¤©
            let today = new Date();
            today.setHours(0, 0, 0, 0);

            let selectedDate = new Date(pickupDate.value);

            if (selectedDate < today) {
                alert("å–è²¨æ—¥æœŸä¸èƒ½æ—©æ–¼ä»Šå¤©");
                return false;
            }

            if (!pickupDate.value) {
                alert("è«‹é¸æ“‡å–è²¨æ—¥æœŸ");
                return false;
            }

            if (pickupMethod.value === "å†·è—å®…é…" && !shippingAddress.value.trim()) {
                alert("è«‹å¡«å¯«å®…é…åœ°å€");
                return false;
            }

            if (
                Number(tiramisu.value) === 0 &&
                Number(basque_slice.value) === 0 &&
                Number(basque_whole.value) === 0 &&
                Number(lemon_slice.value) === 0 &&
                Number(lemon_whole.value) === 0
            ) {
                alert("è«‹è‡³å°‘é¸æ“‡ä¸€é …å•†å“");
                return false;
            }

            pickupInfoField.value =
                pickupMethod.value === "è‡ªå–"
                    ? "è‡ªå–\nå–è²¨æ—¥æœŸï¼š" + pickupDate.value
                    : "å†·è—å®…é…\nå–è²¨æ—¥æœŸï¼š" + pickupDate.value + "\nå®…é…åœ°å€ï¼š" + shippingAddress.value;

            let summary = "";

            if (tiramisu.value > 0) summary += "ææ‹‰ç±³è˜‡ x" + tiramisu.value + "\n";
            if (basque_slice.value > 0) summary += "å·´æ–¯å…‹åˆ‡ç‰‡ x" + basque_slice.value + "\n";
            if (basque_whole.value > 0) summary += "å·´æ–¯å…‹6å‹ x" + basque_whole.value + "\n";
            if (lemon_slice.value > 0) summary += "æª¸æª¬åˆ‡ç‰‡ x" + lemon_slice.value + "\n";
            if (lemon_whole.value > 0) summary += "æª¸æª¬æ•´æ¢ x" + lemon_whole.value + "\n";

            summary += "\nè¨‚å–®ç¸½é¡ï¼š" + currentFinal;

            summaryField.value = summary;
            subtotalField.value = currentSubtotal;
            discountField.value = currentDiscounted;
            shippingField.value = currentShipping;
            finalField.value = currentFinal;

            formSubmitted = true;

            return true;
        }

        function submitted() {
            if (formSubmitted) {
                alert("è¨‚å–®å·²æˆåŠŸé€å‡ºï¼");
                document.getElementById("orderForm").reset();
                formSubmitted = false;
                calculate();
            }
        }

        calculate();

    </script>

</body>
</html>